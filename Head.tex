
%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:

%中文CTEX包，字号，行间距，页面尺寸 
\documentclass[a4paper, zihao=-4, linespread=1.2]{ctexrep} 

% 最小行间间距设定
\setlength{\lineskiplimit}{3pt} 
\setlength{\lineskip}{3pt}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% 设置中文字体
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\setCJKfamilyfont{songti}{SimSun}  
\setCJKfamilyfont{heiti}{SimHei}  
\setCJKfamilyfont{kaishu}{KaiTi}  
\setCJKfamilyfont{fangsong}{FangSong}
\setCJKfamilyfont{wenquanyi}{WenQuanYi Micro Hei}

\newcommand*{\songti}{\CJKfamily{songti}} % 宋体  
\newcommand*{\heiti}{\CJKfamily{heiti}}   % 黑体  
\newcommand*{\kaishu}{\CJKfamily{kaishu}}  % 楷书  
\newcommand*{\fangsong}{\CJKfamily{fangsong}} % 仿宋  
\newcommand*{\wenquanyi}{\CJKfamily{wenquanyi}}    % 文泉驿

\setCJKmainfont[BoldFont={Source Han Serif CN}]{Source Han Serif CN}
\xeCJKsetup{CJKmath=true}
\setCJKmathfont{KaiTi}  % 数学环境中使用楷体

% 颜色
\usepackage[table]{xcolor}

\CTEXsetup[name={\S,}]{section}   %标题前面加标记

%章不使用中文表达
\renewcommand{\CTEXthechapter}{\thechapter}

% 目录和章节样式
\usepackage{titlesec}
\usepackage{titletoc}   % 用于目录

\titlespacing{\chapter}{0pt}{0pt}{12pt} %章标题和后面的间隔
\titlecontents{chapter}[1.5em]{}{\contentslabel{1.5em}}{\hspace*{-2em}}{\hfill\contentspage}
\titlecontents{section}[3.3em]{}{\contentslabel{1.8em}}
    {\hspace*{-2.3em}}{\titlerule*[8pt]{$\cdot$}\contentspage}
\titlecontents*{subsection}[2.5em]{\small}{\thecontentslabel{} }{}{, \thecontentspage}[;\qquad][.]

% 章节样式
\setcounter{secnumdepth}{3} % 一直到subsubsection
\def\LV{\vrule height 2cm depth 0.5cm\hspace{0.1cm}}
\def\GrosCarreAvecUnChiffre#1{%
  \rlap{\vrule height 0.8cm width 1cm depth 0.2cm}%
  \rlap{\hbox to 1cm{\hss\mbox{#1}\hss}}%
  \vrule height 0pt width 1cm depth 0pt}
\newcommand{\chaformat}[1]{%          
\hbox{%
    \huge 
    \LV\LV\LV\LV\LV\LV\LV\LV\LV\LV
    \hspace{-0.5cm}%
    \GrosCarreAvecUnChiffre{\chapterfont\textcolor{white}{\thechapter}}
    \hspace{0.2cm}\hbox{#1}%
}}

\titleformat{\chapter}[display]{\LARGE\sffamily}{}{0pt}{\chaformat}
\titleformat*{\section}{\centering\Large\bfseries}
\titleformat{\subsubsection}[hang]{\bfseries\large}{\rule{1.5ex}{1.5ex}}{0.5em}{}
